<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–õ–∞–±—ñ—Ä–∏–Ω—Ç –¥–æ –ø–æ–¥–∞—Ä—É–Ω–∫—É üéÅ</title>
<style>
  body { margin:0; overflow:hidden; background:#fef6e5; touch-action: none; font-family: Arial;}
  #gameArea { position:relative; width:100vw; height:100vh; background:#fff6e5;}
  #player { position:absolute; width:50px; height:50px; left:10px; top:calc(100vh - 60px); z-index:5; }
  #gift { position:absolute; width:60px; height:60px; left:50%; top:50%; transform:translate(-50%,-50%); z-index:5;}
  #monster { position:absolute; width:50px; height:50px; left:50%; top:30%; transform:translate(-50%,0); z-index:4; cursor:pointer;}
  .wall { position:absolute; background:#444; z-index:3; }
  #confetti { position:absolute; width:100%; height:100%; pointer-events:none; display:none; z-index:10;}
</style>
</head>
<body>

<div id="gameArea">
  <img id="player" src="player.png" alt="–ì—Ä–∞–≤–µ—Ü—å">
  <img id="gift" src="gift.png" alt="–ü–æ–¥–∞—Ä—É–Ω–æ–∫">
  <img id="monster" src="monster.png" alt="–ú–æ–Ω—Å—Ç—Ä">
  <canvas id="confetti"></canvas>
</div>

<script>
const gameArea = document.getElementById('gameArea');
const player = document.getElementById('player');
const gift = document.getElementById('gift');
const monster = document.getElementById('monster');
const confettiCanvas = document.getElementById('confetti');
const ctx = confettiCanvas.getContext('2d');
confettiCanvas.width = window.innerWidth;
confettiCanvas.height = window.innerHeight;

let posX = 10;
let posY = window.innerHeight - 60;

let monsterClicks = 0;

// –õ–∞–±—ñ—Ä–∏–Ω—Ç —Å—Ç—ñ–Ω–∏
const walls = [];
function createWall(x, y, w, h){
  const wall = document.createElement('div');
  wall.classList.add('wall');
  wall.style.left = x+'px';
  wall.style.top = y+'px';
  wall.style.width = w+'px';
  wall.style.height = h+'px';
  gameArea.appendChild(wall);
  walls.push(wall);
}
// –ü—Ä–∏–∫–ª–∞–¥ –ª–∞–±—ñ—Ä–∏–Ω—Ç—É (–º–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –±—ñ–ª—å—à–µ)
createWall(100,100,200,20);
createWall(300,150,20,200);
createWall(50,300,250,20);

// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è
function isColliding(el1Rect, el2Rect){
  return !(el1Rect.right < el2Rect.left || 
           el1Rect.left > el2Rect.right || 
           el1Rect.bottom < el2Rect.top || 
           el1Rect.top > el2Rect.bottom);
}

// –û–±—Ä–æ–±–∫–∞ —Ä—É—Ö—É
function movePlayer(dx, dy){
  let newX = posX + dx;
  let newY = posY + dy;

  const tempRect = {left:newX, top:newY, right:newX+50, bottom:newY+50};

  for(const wall of walls){
    const wallRect = wall.getBoundingClientRect();
    if(isColliding(tempRect, wallRect)) return; // –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è –∑—ñ —Å—Ç—ñ–Ω–æ—é
  }

  // –º–æ–Ω—Å—Ç—Ä –±–ª–æ–∫—É—î —Ä—É—Ö, —è–∫—â–æ –Ω–µ –∫–ª—ñ–∫–Ω—É–ª–∏ 3 —Ä–∞–∑–∏
  const monsterRect = monster.getBoundingClientRect();
  if(monsterClicks < 3 && isColliding(tempRect, monsterRect)) return;

  posX = newX;
  posY = newY;
  player.style.left = posX+'px';
  player.style.top = posY+'px';

  checkGift();
}

// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –ø–æ–¥–∞—Ä—É–Ω–∫—É
function checkGift(){
  const playerRect = player.getBoundingClientRect();
  const giftRect = gift.getBoundingClientRect();
  if(isColliding(playerRect, giftRect)){
    showConfetti();
  }
}

// –ö–æ–Ω—Ñ–µ—Ç—ñ
function showConfetti(){
  confettiCanvas.style.display='block';
  const pieces=[];
  for(let i=0;i<200;i++){
    pieces.push({x: Math.random()*window.innerWidth, y: Math.random()*window.innerHeight, r: Math.random()*6+2, color: `hsl(${Math.random()*360},100%,50%)`, dy: Math.random()*5+2});
  }
  function animate(){
    ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
    for(const p of pieces){
      ctx.fillStyle = p.color;
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
      ctx.fill();
      p.y += p.dy;
      if(p.y>window.innerHeight)p.y=0;
    }
    requestAnimationFrame(animate);
  }
  animate();
  alert("üéâ –í—ñ—Ç–∞—î–º–æ! –¢–∏ –≤—ñ–¥–∫—Ä–∏–≤ –ø–æ–¥–∞—Ä—É–Ω–æ–∫!");
}

// –ú–æ–Ω—Å—Ç—Ä: –∫–ª—ñ–∫ –ø–æ –Ω—å–æ–º—É
monster.addEventListener('click', ()=>{
  monsterClicks++;
  if(monsterClicks>=3){
    monster.style.opacity = 0.5; // –ø—Ä–æ—Ö—ñ–¥–Ω–∏–π
  }
});

// –°–≤–∞–π–ø–∏ / drag –¥–ª—è –º–æ–±—ñ–ª—å–Ω–æ–≥–æ
let startX, startY;
player.addEventListener('touchstart',(e)=>{
  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;
});
player.addEventListener('touchmove',(e)=>{
  let dx = e.touches[0].clientX - startX;
  let dy = e.touches[0].clientY - startY;
  movePlayer(dx, dy);
  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;
  e.preventDefault();
});

// –∫–ª–∞–≤—ñ—à—ñ –¥–ª—è –ü–ö
document.addEventListener('keydown',(e)=>{
  const step=20;
  if(e.key==='ArrowUp') movePlayer(0,-step);
  if(e.key==='ArrowDown') movePlayer(0,step);
  if(e.key==='ArrowLeft') movePlayer(-step,0);
  if(e.key==='ArrowRight') movePlayer(step,0);
});
</script>

</body>
</html>
